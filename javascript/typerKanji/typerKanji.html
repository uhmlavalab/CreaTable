<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8" />
    <title>TyperKanji</title>
</head>
<body>
    <div id='topDiv'>
    </div>
    <div id='infoDiv'>
        <input type='text' id ='idInput'>
    </div>
</body>

<script type="text/javascript" src="../lib/konva.js"></script>
<script type="text/javascript" src="kcombiner.js"></script>
<script type="text/javascript" src="visuals.js"></script>
<script type="text/javascript" src="mechanics.js"></script>
<script type="text/javascript" src="101convert.js"></script>
<script type="text/javascript" src="102convert.js"></script>

<script type="text/javascript">
var debug           = true;
var allKanji        = combineConverted();
var visuals         = {};
var gvStartTime     = Date.now();
var gvOngoingTimer  = 0;
var kanjiRotation   = [];



setupTheCanvas(); //creates a var called visuals
setInputBoxSizing();
resetAllKanji();

idInput.addEventListener('keydown', matchEnteredText);

setInterval(mainUpdater, 5);



function mainUpdater() {

    moveActiveKanji();

    visuals.stage.draw();

} //end mainUpdater


function setInputBoxSizing() {
    //create kanji input since it needs text conversion to work correctly.
    var idInput = document.getElementById('idInput');
        idInput.size = 6;
        idInput.style.fontSize = window.innerHeight * 0.1 + 'px';

    var infoDiv = document.getElementById('infoDiv');
        infoDiv.style.position = 'absolute';
        infoDiv.style.top = window.innerHeight/2 + 'px';
        infoDiv.style.left = '10px';
        infoDiv.style.backgroundColor = 'lightgray';

}


function matchEnteredText(e) {
    if(e.keyCode === 13){
        if(debug) { console.log('Entered text:' + idInput.value); }

        var val = idInput.value;
        idInput.value = '';

        for(var i = 0; i < visuals.allKanji.length; i++) {
            if( val === visuals.allKanji[i].vYomimono.text().trim() || val === visuals.allKanji[i].vKanji.text().trim() ) {
                visuals.allKanji[i].originalData.difficulty--;
                resetKanji( visuals.allKanji[i] );
            }
        }

    }
}


</script>



</html>